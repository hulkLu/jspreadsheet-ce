<script type="text/javascript" src="index.js"></script>
<link rel="stylesheet" href="jspreadsheet.css" type="text/css" />

<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons" />

<link rel="stylesheet" type="text/css"
    href="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.js"></script>

<p>
    <button onclick="toggleDisplay()">点击setData</button>
</p>

<div id="spreadsheet"></div>

<script>
    function toggleDisplay() {
        console.log('myTable', myTable);

        myTable.options.columns = [
            {
                "title": "项目",
                "type": "text",
                "readOnly": true,
                "width": 180
            },
            {
                "title": "单位",
                "type": "text",
                "readOnly": true,
                "width": 180
            },
            {
                "title": "Cut1实测值",
                "type": "hidden",
                "width": 120
            },
            {
                "title": "Cut1校正值",
                "type": "numeric",
                "allowEmpty": true,
                "width": 120
            },
        ];

        myTable.setData([
            ['PHP', '14:00', '14:00', '12331323', "1", '12323aasd'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
            ['Javascript', '16:30', '14:00'],
        ])
        myTable.el.innerHTML = '';
        myTable.createTable();
        // myTable
        console.log('myTable.options.columns', myTable.options.columns);
        console.log('myTable.options.columns', myTable.getData());


    }
</script>
<script>

    var data2 = [
        ['PHP', '14:00'],
        ['Javascript', '16:30'],
    ];

    var customColumn = {
        // Methods
        closeEditor: function (cell, save) {
            var value = cell.children[0].value;
            cell.innerHTML = value;
            return value;
        },
        openEditor: function (cell) {
            // Create input
            var element = document.createElement('input');
            element.value = cell.innerHTML;
            // Update cell
            cell.classList.add('editor');
            cell.innerHTML = '';
            cell.appendChild(element);
            $(element).clockpicker({
                afterHide: function () {
                    setTimeout(function () {
                        // To avoid double call
                        if (cell.children[0]) {
                            myTable.closeEditor(cell, true);
                        }
                    });
                }
            });
            // Focus on the element
            element.focus();
        },
        getValue: function (cell) {
            return cell.innerHTML;
        },
        setValue: function (cell, value) {
            cell.innerHTML = value;
        },
    }

    myTable = jspreadsheet(document.getElementById('spreadsheet'), {
        data: data2,
        // columns: [
        //     { type: 'text', title: 'Course Title 1', width: 300 },
        //     { type: 'text', title: 'Course Title 2', width: 300 },
        //     // { type: 'text', title: 'Course Title 3', width: 300 },
        //     // { type: 'text', title: 'Course Title 4', width: 300 },
        //     // { type: 'text', title: 'Course Title 5', width: 300 },
        //     // { type: 'text', title: 'Time', width: 100, editor: customColumn },
        // ],
        // fixedRows: 5,
        minDimensions: [30, 10],
        // colHeaders: Array.from({ length: 100 }, (v, i) => i + 1),
        tableWidth: "800px",
        tableHeight: "85vh",
        tableOverflow: true,
        freezeColumns: 2,
        freezeRows: 0,
        rowResize: true,
        // onbeforechange(el, cell, x, y, value) {
        //     console.log('onbeforechange', el, cell, x, y, value);

        //     return [
        //         [...value[0]]
        //     ];
        // },
        onload(element, instance) {
        },
    });
</script>